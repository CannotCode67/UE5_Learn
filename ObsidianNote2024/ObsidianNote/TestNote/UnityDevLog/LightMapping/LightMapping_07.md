Baking lights with transparent material 

One mode of the view port is called texel validity. When we bake lightmap, each checker(texel) would fire one or multiple rays, right? When rays fired by the same checker always hit the back face of a polygon, this checker would be marked as invalid. And it would be red in the texel validity mode. The valid ones are green. One setting called back face tolerance is used to determine the threshold of marking one texel to be invalid or not. 

Invalid checker would neither contribute to nor receive the lighting info in lightmap, even though the object it belongs is marked as static. Situations like checkers inside a mesh(glass or whatever) would result in being invalid, but we still want those areas to receive lighting info, what if I have a light inside that area, right? The way we can get this working is to either mark the glass as not static or if it is one whole mesh, turn on double sided GI for that glass material. This option is only available for material sourcing from a PBR shader in shader graph. Unity's standard shader would need to turn on two-side rending for that result, since currently two-side rendering and double-side GI is coupled for standard shader in 2019LTS. In 2020LTS, PBR shader in shader graph has two-side render option in graph setting, and double-side GI option still resides in material inspector window. The two-side render option although enables us to render the back face, but the back face doesn't receive any lighting info, not realtime and not baked lighting. It is not much a problem for glass, but it is bad for foliage. Because often we do see the back face of a foliage mesh, and it is noticeably darker than the front face. The solution I find is to modified the shader in shader graph using following method. The first one proves to be working, and the second doesn't seem to work on my testing foliage mesh, ivy on the wall.
![[GetImages (1).png]]
![[GetImages (3).png]]
With the first method, we are modifying the normal vector of the mesh, so any effect depending on the normal vector to be default will not work, like the on-top snow effect. And this method works with realtime lighting only, not the baked lighting. So, if we have to have the snow effect, I would go into maya to either delete any faces with back face facing toward the player, or just uncheck the two-side render option. For better performance, deleting mesh is a better choice, but it takes more work. For ivy on the wall, it is viable because we only get camera angle toward the wall. However, for foliage that stands along on the ground, like a wheat or flower, we have to implement the first method so both sides are probably lit to stay consistent color-wise, since we do have a 360 camera angle to inspect this kind of foliage mesh in game. For methods to work with baked lighting, I am still looking. 

The isTransparent setting in the lightmap parameters used by the mesh renderer component is an old solution for a deprecated lightmapper algorithm called Enlighten, it only works when we use Enlighten to bake the lightmap, which we are not. So forget it.

Artifacts of baking light when using modular pieces.
![[GetImages (2).png]]
We can see there is one slightly black line where two identical walls meet. It is the result of the lightmaps of those two walls are baked under different thread of the CPU. So, sometimes, it is not there. However, with so many modular pieces, this artifact is almost bound to happen. There isn't really much we can do. The solution is to create a combining piece of those walls, and let the artifacts reside in the corners where is darker for some shadowing. Or find some similar clever way to hide it. Only the wall, the ceiling and the floor would need this treatment. For other things, modular approach still works just fine. And don’t get it disappointed at modular approach, it is great for building the place. Just do this treatment in later stage like optimization. If the scene is dark and the artifacts are far away, I would argue we might not need to do this treatment.